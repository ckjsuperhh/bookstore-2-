# 业务要求

## 基本要求

设计并实现一个书店管理系统。该书店管理系统应当面向三类人员：顾客、销售人员和店长。最终交接物为需求分析文档（13 周周一前）、总体设计文档和源代码（16 周周四前）。关于程序有以下要求：

- 编程语言限制：软件主体（除 bonus 部分外）完全使用 C++ 编写；
- 系统数据需要存储在外存中；
- 系统首次运行时应当创建店主账户，其具有最高权限；
- 管理系统应当使用命令行进行交互；

- 系统支持嵌套登录，即允许多个帐户同时处于登录状态；允许同一帐户同时多次登录。输入的指令视为最后登录的帐户操作；

## 游客

游客只能注册/登录用户。

## 顾客

顾客可以查询和购买图书。

- 每种图书包含的信息有：ISBN 号（20 个字符，每本正版书都有惟一的标识）、书名（60 个字符）、作者（60 个字符）、关键字（可以有多个，总共不超过 60 个字符）、库存量（整型）、单价（非负实数）；

- 查询图书时可以根据 ISBN 号、作者名字、关键字、书名中的任意组合进行查询；
- 购买图书时，我们通过给定的 ISBN 号和购买数量来进行操作；

## 销售人员

销售人员可以执行所有顾客执行的操作，同时也可以进行进货、图书信息录入、图书信息修改、用户创建。

- 进货时需指定 ISBN 号、数量、进货价格;
- 第一次录入图书时，应当输入其完整信息；

## 店长

店长可以执行所有销售人员和顾客可以执行的功能，同时也可以查询某段时间的采购信息（即按照采购顺序输出采购图书的 ISBN 号、数量、单价等）、销售情况（即按照销售顺序输出售出图书的 ISBN 号、数量、单价等）、盈利信息（即输出该段时间的收入，支出以及利润）。除此之外，店长也可以查看各员工的工作情况报告（即按操作顺序输出每次操作类型及其对象，如创建用户操作以及对应的用户信息）和系统的整体工作日志。

## 性能需求

考虑到应用场景下帐户和图书数量较大，故**禁止将主体数据存储于内存**，应实时读写文件数据。运行过程中程序创建的文件数量不得超过 20 个。

#### 需求分析文档

根据给出的要求文档，你需要用图或文字描述**书店系统**各个子系统的业务流程和数据流图。文档具体要求如下：

- 业务流图

  - 请绘制书店系统的业务流图；

- 数据流图

  - 请绘制书店系统的数据流图；

- 数据词典

  - 请描述书店系统涉及的数据项及其含义；

- 功能说明

  - 请描述书店系统各个模块的功能，包括模块名称、功能描述、输入输出参数。例如：

    - 1.	功能1：名字、输入、输出、所做的处理

    - 2.  功能2

    - 3.  ... 

- 用户交互设计

  - 请设计所有的命令格式和对应的输出；



数据词典：

①用户信息（类）

用户的账号密码（字符串）

登陆记录（时间，登陆数量）（整型，整型）

查询记录（时间，查询内容，对应书目）（整型，字符串，字符串）

购买记录（时间，购买书目，对应书目信息）（整型，字符串，字符串）

②图书信息

书名（字符串）

库存量（整型）

作者（字符串）

关键字（字符串数组）

ISBN码（字符串）

价格（浮点型）

进货价格（浮点型）

③销售情况

销售记录（类）：销售时间（整型），图书ISBN码（字符串），售卖员工账号（字符串），用户账号（字符串）

④收支情况

进货花销（浮点数）

售卖盈利（浮点数）

净收入（浮点数）

⑤采购信息

购买记录（类）：购买时间（整型），图书书名（字符串），数量（整型），ISBN码（字符串），进货价格（浮点数）

⑥操作信息

操作记录（类）：操作时间（整型），操作类型（类——包含上述各种操作），操作员工账号（字符串）



功能说明：

1.注册：输入用户名及密码，核验是否符合要求，并且输出注册是否成功

2.登录：输入用户名及密码，核验是否符合要求，并且输出登录是否成功

3.查询：输入特定组合，在图书信息数据库中查询，并且输出相关信息

4.购买：输入ISBN以及书名，输出购买是否成功

5.进货：输入进货的书的信息，修改支出以及采购信息，输出修改是否成功

6.录入：输入录入的书的信息，修改图书信息数据库，输出录入是否成功

7.修改：输入修改的书的信息，修改图书信息数据库，输出修改是否成功

8.创建：输入用户名及密码，核验是否符合要求，并且输出创建是否成功

9.查询采购信息：输入查询指令，查询采购信息并且输出

10.查询销售信息：输入查询指令，查询销售信息并且输出

11.查询盈利信息：输入查询指令，查询收支信息并且输出

12.查询员工信息：输入查询指令，查询操作信息并且输出

13.查询整体日志信息：输入查询指令，查询操作信息并且输出



用户交互设计：

•注册格式：enroll_user -t [手机号]- n [账号] -p [密码]-p [再次确认]-v [验证码]

•输出：如果注册成功，输出“用户[账号]信息注册成功”；若注册失败，输出相应错误提示，如“验证码输入错误，请重新输入”。

•登录格式：log_user -n [账号] -p [密码]

•输出：如果登录成功，输出“用户[账号]信息登录成功”；若登录失败，输出相应错误提示，如“密码输入错误，请重新输入”。

•查询书本格式：query_book -k [查询关键字（如ISBN码、书名）]

•输出：展示符合查询关键字的书本信息，如果没有查询到则输出“未找到符合条件的书本信息”。

•购买书本格式：sell_book -c[IBSN码] -n [书名]

•输出：查询书本信息，若符合购买要求则输出“购买成功”，如果没有查询到则输出“未找到符合条件的书本信息，无法购买”。

•进货格式：purchase_book - c[IBSN码] -n [书名] -p [进货价格] -n [数目]

•输出：输出“进货信息修改成功”。

•修改书本信息命令格式：modify_book -k [修改信息的名称，如书名等] -i [具体修改信息]

•输出：若修改成功，输出“图书[书名 ISBN码]信息修改成功”；失败则输出错误提示。

•录入书本信息命令格式：enter_book -i [ISBN码] -a [作者] -n [书名] -p [价格]-p [进货价] -r [库存] -c [关键字]

•输出：若录入成功，输出“图书[书名 ISBN码]信息修改成功”；失败则输出错误提示。

•创建格式：create_user -n [账号] -p [密码]

•输出：如果创建成功，输出“用户[账号]信息创建成功”；若创建失败，输出相应错误提示，如“账号已存在，请勿重复创建”。

•查询采购信息格式：query_purchase -t [时间段]

•输出：展示符合查询时间的书本购入信息，如果没有查询到则输出“未找到符合条件的书本信息”。

•查询销售信息格式：query_sell

•输出：按顺序输出书本售卖信息，如果没有查询到则输出“无销售记录”。

•查询销售信息格式：query_profit -t [时间段]

•输出：按顺序输出“收入为：i [收入]，支出为：e [支出]，利润为：p [利润]”，如果没有查询到则输出“无收支记录”。

•查询采购信息格式：query_staff -n [员工账户]

•输出：展示员工的操作信息，如果没有查询到则输出“未找到符合条件的员工操作信息”。

•查询采购信息格式：query_operation 

•输出：按顺序输出所有操作信息，如果没有查询到则输出“无操作记录”。
